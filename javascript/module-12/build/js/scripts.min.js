"use strict";var form=document.querySelector(".js-form"),input=document.querySelector(".js-input"),buttonAdd=document.querySelector(".js-add"),buttonDelete=document.querySelector(".js-delete"),parent=document.querySelector(".root"),validUrl=/^((ftp|http|https):\/\/)?(www\.|)([A-z|0-9]+)\.([A-z]{2,})/,sourse=document.querySelector("#tab").innerHTML.trim(),template=Handlebars.compile(sourse);function handleOnSubmit(e){e.preventDefault();var t=input.value;validUrl.test(t)?(fetchLink(t).then(function(e){if(localStorage.getItem(e.url)==t)return alert("This tab is already here!");localStorage.setItem(e.url,e.url);var r=template(e);parent.insertAdjacentHTML("afterbegin",r)}),form.reset()):alert("Invalid URL!")}function fetchLink(e){return fetch("https://api.linkpreview.net/?key=5bbc427db184bade881089c46d1ce94309e553dcca374&q="+e).then(function(e){if(e.ok)return e.json();throw new Error("Error fetching data")}).catch(function(e){console.error("Error: ",e)})}function handleOnDelete(e){if(e.preventDefault(),"BUTTON"===e.target.nodeName){var t=e.target.parentNode.firstElementChild;localStorage.removeItem(t.textContent),e.target.parentNode.remove()}}form.addEventListener("submit",handleOnSubmit),parent.addEventListener("click",handleOnDelete),console.log(Object.keys(localStorage)),Object.keys(localStorage).forEach(function(e){fetchLink(e).then(function(e){var t=template(e);parent.insertAdjacentHTML("afterbegin",t)})});